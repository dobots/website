<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Distributed Organisms B.V., shorthand DoBots, specializes in Smart Robots and Smart Buildings. DoBots implements localization, mapping, and navigation algorithms on robots and indoor localization, automation, and tracking algorithms in buildings.">
<meta name="author" content="Distributed Organisms B.V.">
<link rel="icon" type="image/x-icon" href="/images/favicon.ico?">
<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.png">


<title>DoBots | Android and rosjava</title>




<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<link rel="stylesheet" type="text/css" href="/assets/elusive-webfont-b4b08c54aa385fbc9433a5864604eb0a37430d49016644f6c2225b9c9f6528d4.css">

<!-- Custom styles for this template -->

<link rel="stylesheet" type="text/css" href="/assets/flexslider-af37d743866caa19c33f16fdb8585f2b6331c7b25bfcb9b0b2fd4720d61df9b5.css">
<link rel="stylesheet" type="text/css" href="/assets/dobots-style-6a93bbafd311befa179f35a7f457349cb1b7ed24686877defdb4530f84dcc1fe.css">

<!--[if lt IE 9]>
	<script src="/assets/themes//resources/respond/Respond.min.js"></script>
<![endif]-->

<link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
<link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">


</head>

<body>
    <!--
<div id="headerBar" onclick="location.href='http://crownstone.rocks';">
<center>
<h4>
<a href="http://crownstone.rocks/">http://crownstone.rocks</a> power outlet!
</h4>
</center>
</div>
    -->
<header id="header" class="mini-wrap">
	<div class="navbar navbar-inverse" role="navigation">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="/"><img src="/images/logo.png" class="img-responsive" alt="DoBots"></a>
			</div>

			<div class="collapse navbar-collapse">
				<ul class="nav navbar-nav navbar-right main-nav">
					
					
					


  
    
      
    
  
    
      
      	
      	<li><a href="/applications/cleaning/">Applications</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/products/autopilot/">Technology</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/jobs/">Jobs</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/blog/">Blog</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/about-us/">About</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/search/">Search</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
	<li><a href="mailto:info@dobots.nl?subject=Get%20in%20contact">Contact</a></li>




				</ul>
			</div>
		</div>
	</div>
</header>

<section id="sub-menu" class="mini-wrap">
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<ul class="list-unstyled sub-menu pull-left slogan">
					<!--					<li>"Computers, come, join us in the real world!"</li> -->
					<li>
<a href="/2014/05/23/best-european-startup/">Best European Startup Award</a> winner of <a href="http://robotlaunch.com/">Robot Launch</a>!
					</li>
				</ul>
                <!--
				<ul class="list-unstyled sub-menu pull-right">
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
					
						
						
							
							
							
							
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
						
					
				</ul>
                -->
			</div>
		</div>
	</div>
</section> <!--end / sub-menu-->


<!--
<div class="page-header">
  <h1>Android and rosjava </h1>
</div>
-->

<div class="container">
	<div class="row post-full">
		<div class="col-md-12">
			<div class="date">
				<strong class="date_month">Jun</strong>
				<strong class="date_day">19</strong>
				<strong class="date_year">2012</strong>
				<!--      <span>19 June 2012</span> -->
			</div>
			
			
			<div class="author-block">
				
				<img src="https://secure.gravatar.com/avatar/818dc2df03cd2f1ca7d6e6e701052f0c?s=40">
				
				<span class="author">Anne van Rossum</span>
			</div>
			
			<div class="post">
				<div class="content">
					
<h1 id="android-and-rosjava">Android and rosjava</h1>

<h2 id="open-source">Open source</h2>

<p><img src="/attachments/rosjava_image.jpg" alt="Random shot of desk" class="float-right"></p>

<p>coders and employees from Google have joined forces to create rosjava. This is
a pure Java implementation of <a href="http://www.willowgarage.com/pages/software/ros-platform">ROS</a> (from Willow Garage). ROS shouldn’t be seen as a solution for
all and everything. So, for what can it be useful? Under other things, it
provides:</p>

<ul>
  <li>utilities for robots to make it easier to visualize, compress and communicate data</li>
  <li>basic data processing software</li>
  <li>drivers for devices of which you might like to address their data (a famous example is the Kinect).</li>
</ul>

<p>Enough to be really useful! However, there is something that is a little bit a
negative point. ROS might be overwhelming if you just start with your first
robot or Android project. It can be quite a pain to figure everything out. So
here we go with a sort tutorial where we will guide you around (undocumented)
issues that will come up.</p>

<h2 id="documentation">Documentation</h2>

<p>First of all, you definitely need to look at the <a href="http://docs.rosjava.googlecode.com/hg/android_core/html/building.html">online documentation of the android_core</a> where you will discover that a lot of documentation online is outdated. The
android core for example does not make use of the “rosmake” utility, but of
the “gradlew” build utility. If you have not installed ROS yet, feel free to
do so. The directions in this blog post will target Ubuntu Precise Penguin
(12.10). You can install using <code>sudo aptitude install ros-fuerte-ros</code>. The
first thing I have to warn against is installing stuff yourself using
mercurial.</p>

<h2 id="setup">Setup</h2>

<p>Feel free to setup the system how you want of course. I tend to use multiple
Eclipse workspaces to keep code together that belongs together. So, a
<code>~/myworkspace/nonequilibrium</code> for statistical physics code, a
<code>~/myworkspace/android</code> for Java code for Android, a <code>~/myworkspace/arduino</code>
for Arduino related code, a <code>~/myworkspace/nodejs</code> for node.js code, and
naturally for ROS: mkdir ~/myworkspace/ros &amp;&amp; cd ~/myworkspace/ros</p>

<p>Please, follow closely the <a href="http://www.ros.org/doc/api/rosinstall/html/rosws_tutorial.html">rosws
tutorial</a> to
create the proper ROS workspace:</p>

<p><code>sudo apt-get install python-pip</code></p>

<p><code>sudo pip install -U rosinstall</code></p>

<p><code>rosws init</code></p>

<p><code>source setup.bash </code></p>

<p>And copy that line indeed to your <code>~/.bashrc</code> file as recommended</p>

<p>Using rosws we can “merge” code from different locations. This will only add
references to the given code or repositories, not the code itself.</p>

<p><code>rosws merge http://android.rosjava.googlecode.com/hg/.rosinstall</code></p>

<p><code>rosws merge http://rosjava.googlecode.com/hg/.rosinstall</code></p>

<p><code>rosws merge /opt/ros/electric/.rosinstall</code></p>

<p>Now to get the code actually and check the results:</p>

<p><code>rosws update</code></p>

<p><code>rosws info</code></p>

<p><code># Expected output:  
workspace: /home/anne/myworkspace/ros  
ROS_ROOT: /opt/ros/fuerte/ros  
Localname       &amp; nbsp;        S SCM  Version-Spec UID  (Spec)  URI  (Spec)
[https://...]  
\\--------- &amp;n; bsp;            &amp;n; bsp; - ---- ------------ -----------
\-------------------------  
ros java_core           &amp;nb; sp;   hg   default      7cfb92045e17
code.google.com/p/rosjava  
/opt/ros/electric/stacks &amp;nb; sp;            &amp;nb; sp;            &amp;nb; sp;  
/opt/ros/electric/ros    ;              ;              ;  
google   &amp;nbs; p;            &amp;nbs; p;    hg   default      736ac32a2ede
code.google.com/p/rosjava.google  
android_core  &amp;n; bsp;            hg   default      9327ca89c140
code.google.com/p/rosjava.android</code></p>

<p>Pay attention that <code>ROS_ROOT</code> is not empty. Eventually check everything using
<code>env | grep ROS</code>. You can also use <code>rospack list-names</code> to return a list of
all packages.</p>

<h2 id="hurdle-1-forgetting-to-source-script">Hurdle 1: Forgetting to source script</h2>

<p>We will try to build our first code:</p>

<p><code>roscd rosjava_core</code></p>

<p>roscd: No such package ‘rosjava_core’</p>

<p>If an error like this happens and <code>rosjava</code> is actually in the <code>rosws info</code>
list, then you will need to call the script in the ROS workspace.</p>

<p><code>source setup.sh</code></p>

<p><code>roscd rosjava_core</code></p>

<p><code>./gradlew install</code></p>

<h2 id="hurdle-2-refer-to-android">Hurdle 2: Refer to Android</h2>

<p>And then similar the other code:</p>

<p><code>roscd google</code></p>

<p><code>./gradlew install</code></p>

<p><code>roscd android_core</code></p>

<p><code>./gradlew debug</code></p>

<p>Execution failed for task ‘:android_acm_serial:updateProject’. A problem
occurred starting command ‘android’.</p>

<p>This fails for me because it cannot find <code>android. </code>Now you will think that
you only need to update your environmental $PATH, however, it is not just bash
that does not find the android binary, but it is <code>ANT</code>, the Java build system.
Hence you will need to add this to your ~/.bashrc file:</p>

<p><code>export PATH=$PATH:/opt/android-sdk- linux_x86/tools</code></p>

<p><code>export CLASSPATH=$CLASSPATH:/opt/android-sdk-linux_x86/tools</code></p>

<p><code>sudo killall java </code></p>

<p>Make sure the <code>JVM</code> is dead. Close all neat Java programs such as Eclipse and
JabRef beforehand. And now run <code>./gradlew clean debug</code> again.</p>

<p>On my system it still complains about the fact that a <em>target needs to be
specified</em>, but for now we will build one project that does not have so many
dependencies:</p>

<p><code>./gradlew android_tutorial_pubsub:clean android_tutorial_pubsub:debug</code></p>

<h2 id="hurdle-3-set-android-target">Hurdle 3: Set Android target</h2>

<p>There is a problem about the absence of the <code>build.xml</code> file on building the
files straight from the repository.</p>

<p>Buildfile: build.xml does not exist!</p>

<p>The solution is simple:</p>

<p><code>cd android_honeycomb_mr2</code></p>

<p><code>android list targets</code></p>

<p>Pick the one that is recent enough for honeycomb, in my case that is number 3.</p>

<p><code>android update project --target 3 --path .</code></p>

<p>You can pick <code>android_tutorial_teleop</code> afterwards for example for which you
will need to do the same. I am curious in streaming the camera from my
smartphone to my computer for now: <code>android_tutorial_camera</code>. Installing on
your smartphone is easy by just connecting your smartphone via USB and after
the build <code>ant installd</code> (where the d stands for the debug version).</p>

<h2 id="hurdle-4-display-image">Hurdle 4: Display image</h2>

<p>According to the <a href="http://www.ros.org/wiki/image_view">ROS wiki</a> image_view
resides apparently in the pipeline package. We also install rxgraph which is a
nice utility to visualize our architecture and last, but not least we will
need to be able to get compressed images (transport plugins):</p>

<p><code>sudo aptitude install ros-fuerte-image- common ros-fuerte-image-pipeline</code></p>

<p><code>sudo aptitude install ros-fuerte-rx </code></p>

<p><code>sudo aptitude install ros-fuerte-image- transport-plugins</code></p>

<p>Now on your PC start the ROS core and note down your IP address:</p>

<p><code>roscore</code></p>

<p><code>sudo ifconfig</code></p>

<p>Start the <strong>CameraTutorial app</strong> on your smartphone and connect to the IP
address you just wrote down, e.g. http://10.10.1.133:11311. You can check
beforehand if you can reach your PC from your smartphone using the browser on
your phone (however, Opera Mobile couldn’t find my server for some reason, so
don’t trust such a check too much). Needless to say, use an IP address and not
some local name only known to your computer. Finally, start the viewer on the
PC side:</p>

<p><code>rosrun image_view image_view image:=/camera/image compressed</code></p>

<p>Done! Proof can be found in the form of the picture (from the camera on my
smartphone) at the top of this blog post obtained by right-clicking in the
image viewer on my PC.</p>


				</div>

				

				
				<hr>

				<div class="social-button-footer">
					<p>
					<a class="btn btn-social-icon btn-twitter" href="http://twitter.com/intent/tweet?url=https://dobots.nl/2012/06/19/android-and-rosjava&amp;text=Android%20and%20rosjava"><i class="icon-twitter"></i></a>
					<a class="btn btn-social-icon btn-facebook" href="http://facebook.com/sharer.php?u=https://dobots.nl/2012/06/19/android-and-rosjava"><i class="icon-facebook"></i></a>
					<a class="btn btn-social-icon btn-googleplus" href="https://plus.google.com/share?url=https://dobots.nl/2012/06/19/android-and-rosjava"><i class="icon-googleplus"></i></a>
					<a class="btn btn-social-icon btn-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://dobots.nl/2012/06/19/android-and-rosjava"><i class="icon-linkedin"></i></a>
					<a class="btn btn-social-icon btn-reddit" href="http://reddit.com/submit?url=https://dobots.nl/2012/06/19/android-and-rosjava&amp;title=Android%20and%20rosjava"><i class="icon-reddit"></i></a>
					</p>
				</div>


				<ul class="pagination">
					
					<li class="prev"><a href="/2012/06/12/visual-fire-detection" title="Visual fire detection">← Previous</a></li>
					
					<li><a href="/blog">Archive</a></li>
					
					<li class="next"><a href="/2012/06/19/implementing-swarm-behavior-with-a-group-of-small-robots" title="Swarm behavior with a group of small robots">Next →</a></li>
					
				</ul>
				<hr>
				


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'dobots'; 
    
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<a href="https://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




			</div>
		</div>
	</div>



<footer id="footer" class="mini-wrap gray">
	<div class="container">
		<div class="row">
			<div class="col-xs-6 col-sm-6 col-md-6 more-padding">
				<img src="/images/youtube.png" alt="youtube"> Watch our <a href="https://www.youtube.com/channel/UC7bsuzp2BfL5F5RX07oLIzw">movies</a> and follow us on <a href="http://facebook.com/dobots">Facebook!</a>
</div>
			<div class="col-xs-6 col-sm-6 col-md-6">
				<ul class="list-items pull-right gutter-top-btm">
					<li><a href="index.html">
						<img src="/images/footer-logo.png" class="img-responsive" alt="DoBots"></a></li>
					<li class="robot-info-dilog">
<a href="#">
						<img src="/images/two-robot.png" width="103" height="85" alt="robot">
					</a>
					<div class="footer-robot-dilog">
						<div class="inner-robot-dilog">
							Do you have a question? <script type="text/javascript">/*<![CDATA[*/var a=new Array(".nl","bots","do","@","fo","in");document.write("<a href='mailto:");for(i=a.length-1;i>=0;i--){document.write(a[i])}document.write("?subject=DoBots Contact' class='btn btn-default'>Yes</a>");/*]]>*/</script>
							<div class="inner-arrow-right">
								<img alt="dilog" class="img-responsive" src="/images/inner-dilog.png" draggable="false"> </div>
						</div>

					</div>
					</li>
				</ul>

			</div>
		</div>
	</div>
</footer>




  <script type="text/javascript">
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-17146802-10', 'auto');
ga('send', 'pageview');
</script>
<script type="text/javascript" async src="https://www.google-analytics.com/analytics.js"></script>






<!-- in debug mode, Google Chrome worries about .map files, do not worry -->


<script type="text/javascript" src="/assets/jquery.min-7f30f220312176c728c3bb41a567ccc2e1ce2e7a8dd7c9cefd59fe197ba047b2.js"></script>

<!-- Latest compiled and minified JavaScript -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script type="text/javascript" src="/assets/jquery.flexslider-122776e067a7b77f685ce8fbbd3cb75136ce8ca23f243a50de28c1545ec6bb68.js"></script>

<script type="text/javascript" async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script type="text/javascript">
$(window).load(function(){
		$('.text-slider').flexslider({
			animation: "slide",
			start: function(slider){
				$('body').removeClass('loading');
			}
		});
	});
</script>

</div>
</body>
</html>
