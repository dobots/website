<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Distributed Organisms B.V., shorthand DoBots, specializes in Smart Robots and Smart Buildings. DoBots implements localization, mapping, and navigation algorithms on robots and indoor localization, automation, and tracking algorithms in buildings.">
<meta name="author" content="Distributed Organisms B.V.">
<link rel="icon" type="image/x-icon" href="/images/favicon.ico?">
<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.png">


<title>DoBots | Robot Remote Control with ØMQ</title>




<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<link rel="stylesheet" type="text/css" href="/assets/elusive-webfont-b4b08c54aa385fbc9433a5864604eb0a37430d49016644f6c2225b9c9f6528d4.css">

<!-- Custom styles for this template -->

<link rel="stylesheet" type="text/css" href="/assets/flexslider-af37d743866caa19c33f16fdb8585f2b6331c7b25bfcb9b0b2fd4720d61df9b5.css">
<link rel="stylesheet" type="text/css" href="/assets/dobots-style-6a93bbafd311befa179f35a7f457349cb1b7ed24686877defdb4530f84dcc1fe.css">

<!--[if lt IE 9]>
	<script src="/assets/themes//resources/respond/Respond.min.js"></script>
<![endif]-->

<link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
<link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">


</head>

<body>
    <!--
<div id="headerBar" onclick="location.href='http://crownstone.rocks';">
<center>
<h4>
<a href="http://crownstone.rocks/">http://crownstone.rocks</a> power outlet!
</h4>
</center>
</div>
    -->
<header id="header" class="mini-wrap">
	<div class="navbar navbar-inverse" role="navigation">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="/"><img src="/images/logo.png" class="img-responsive" alt="DoBots"></a>
			</div>

			<div class="collapse navbar-collapse">
				<ul class="nav navbar-nav navbar-right main-nav">
					
					
					


  
    
      
    
  
    
      
      	
      	<li><a href="/applications/cleaning/">Applications</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/products/autopilot/">Technology</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/jobs/">Jobs</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/blog/">Blog</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/about-us/">About</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/search/">Search</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
	<li><a href="mailto:info@dobots.nl?subject=Get%20in%20contact">Contact</a></li>




				</ul>
			</div>
		</div>
	</div>
</header>

<section id="sub-menu" class="mini-wrap">
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<ul class="list-unstyled sub-menu pull-left slogan">
					<!--					<li>"Computers, come, join us in the real world!"</li> -->
					<li>
<a href="/2014/05/23/best-european-startup/">Best European Startup Award</a> winner of <a href="http://robotlaunch.com/">Robot Launch</a>!
					</li>
				</ul>
                <!--
				<ul class="list-unstyled sub-menu pull-right">
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
					
						
						
							
							
							
							
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
						
					
				</ul>
                -->
			</div>
		</div>
	</div>
</section> <!--end / sub-menu-->


<!--
<div class="page-header">
  <h1>Robot Remote Control with ØMQ </h1>
</div>
-->

<div class="container">
	<div class="row post-full">
		<div class="col-md-12">
			<div class="date">
				<strong class="date_month">Apr</strong>
				<strong class="date_day">26</strong>
				<strong class="date_year">2013</strong>
				<!--      <span>26 April 2013</span> -->
			</div>
			
			
			<div class="author-block">
				
				<img src="https://secure.gravatar.com/avatar/ca712f67c149fb1b49fdd673a4a758a5?s=40">
				
				<span class="author">Dominik Egger</span>
			</div>
			
			<div class="post">
				<div class="content">
					
<h1 id="robot-remote-control-with-ømq">Robot Remote Control with ØMQ</h1>

<p>In earlier blog posts we presented the Swarm Control App where we added
different robots to an Android app in order to control them remotely and
display their sensor data on the phone. However, this was only the first step;
what we want is to connect the robots to the Cloud where we process the sensor
data and send back remote commands to the robot.</p>

<p>As a little showcase we took a Romo 1.0, equipped it with an Android
smartphone and wrote an app which publishes the video from it’s camera and
listens to remote commands. The camera video is sent to a server which
forwards the video stream to subscribed client(s). The clients in turn can
send remote commands back to the server which relays it to the Romo. The
message passing is done with <a href="http://www.zeromq.org/">ØMQ</a>, a high
performance, asynchronous message system for many different languages which
provides message queues, N-to-N connections, different messaging patterns, and
several messaging transports. On the server we are running node.js to forward
the ØMQ messages and provide the website for the web client.</p>

<div class="videowrapper">
		<iframe width="560" height="420" src="//www.youtube.com/embed/wCX6XXzhrCM?color=white&amp;theme=light"></iframe>
		</div>

<h2 id="romo-brain">Romo Brain</h2>

<p>The source code of the app running on Romo can be found
<a href="https://github.com/eggerdo/RomoBrain">here</a> and uses the
<a href="https://github.com/Romotive/Romo-SDK-Gen2">RomoSDK</a> provided by Romotive. It
compresses the camera frames as 640 x 480 JPEG images and sends them encoded
in ØMQ messages to the server. It also subscribes to ØMQ messages containing
remote control commands which are decoded to control the Romo.</p>

<h2 id="robot-server">Robot Server</h2>

<p>On the server side we are running node.js. The node provides two channels for
video and two channels for command messages. The incoming channels uses the
Push-Pull, the outgoing channel the Pub-Sub pattern. Messages received on the
incoming socket are forwarded to all subscribers on the outgoing channel. In
addition, the node provides another outgoing channel on which every incoming
video message is published encoded as Base64. This stream was added to support
web clients and will be described in more detail later on. The source code can
be found <a href="https://github.com/eggerdo/robot_server.node">here</a>.</p>

<p>The Romo establishes two connections with the Robot Server. It connects to the
incoming video channel of the server to push video messages and subscribes to
the outgoing command channel to receive command messages. The messages are
designed such that the Subscriber can filter messages so that it only receives
messages it is interested in. The server on the other hand will process every
message.</p>

<h2 id="remote-control-client">Remote Control Client</h2>

<p>In order to control the robot and to show the flexibility of ØMQ we
implemented two different clients: an Android app and a web client. However,
there is no limit to the possible clients, since ØMQ comes in over 30
different programming languages.</p>

<h3 id="android-client">Android Client</h3>

<p>The Android app to control the Romo over ØMQ can be found
<a href="https://github.com/eggerdo/RoboTalk-User">here</a>. It provides the possibility
to drive the Romo around and displayes the video stream of the Romo’s camera
on the screen. It subscribes to the outgoing video channel of the Robot
Server, decodes the video message and displays it on the screen. In turn,
remote commands are encoded as a JSON string in a ØMQ message and pushed to
the server.</p>

<h3 id="web-client">Web Client</h3>

<p>The Web Client used to control the Romo from a Web Browser is composed of a
node.js node which serves the HTML web page from a server and a bridge between
WebSockets and ØMQ. The web site uses JavaScript to encode command messages
and decode video messages. Because a website cannot make TCP connections,
WebSockets are used to send the ØMQ messages to the server serving the
website. There a python script provides a bridge between WebSockets and ØMQ to
connect to the Robot Server. The code for the web server and ZmqWebBridge can
be found <a href="https://github.com/eggerdo/robot_ctrl.node">here</a>.</p>

<h2 id="performance">Performance</h2>

<p>Performance of our setup looks quite well. To control the Romo we used an LG
Optimus 2x which delivered a video stream of about 20 fps. The RTT is about
100ms for a video message, and 60 ms for a command message. (This was measured
with an internet connection of 40 Mpbs down and 36 Mbps uplink and includes
encoding and decoding of the data in a ØMQ message as well as transmission to
and back from the server). As a result we get a frame rate of 20 fps on the
receiving side as well. However, using a slower internet connection will
significantly reduce the frame rate on the receiving side and reducing the
image size might be a good idea.</p>


				</div>

				

				
				<hr>

				<div class="social-button-footer">
					<p>
					<a class="btn btn-social-icon btn-twitter" href="http://twitter.com/intent/tweet?url=https://dobots.nl/2013/04/26/robot-remote-control-with-%C3%B8mq&amp;text=Robot%20Remote%20Control%20with%20%C3%98MQ"><i class="icon-twitter"></i></a>
					<a class="btn btn-social-icon btn-facebook" href="http://facebook.com/sharer.php?u=https://dobots.nl/2013/04/26/robot-remote-control-with-%C3%B8mq"><i class="icon-facebook"></i></a>
					<a class="btn btn-social-icon btn-googleplus" href="https://plus.google.com/share?url=https://dobots.nl/2013/04/26/robot-remote-control-with-%C3%B8mq"><i class="icon-googleplus"></i></a>
					<a class="btn btn-social-icon btn-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://dobots.nl/2013/04/26/robot-remote-control-with-%C3%B8mq"><i class="icon-linkedin"></i></a>
					<a class="btn btn-social-icon btn-reddit" href="http://reddit.com/submit?url=https://dobots.nl/2013/04/26/robot-remote-control-with-%C3%B8mq&amp;title=Robot%20Remote%20Control%20with%20%C3%98MQ"><i class="icon-reddit"></i></a>
					</p>
				</div>


				<ul class="pagination">
					
					<li class="prev"><a href="/2013/04/19/extreme-learning-machines" title="Extreme Learning Machines">← Previous</a></li>
					
					<li><a href="/blog">Archive</a></li>
					
					<li class="next"><a href="/2013/05/27/two-websites" title="Two websites">Next →</a></li>
					
				</ul>
				<hr>
				


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'dobots'; 
    
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<a href="https://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




			</div>
		</div>
	</div>



<footer id="footer" class="mini-wrap gray">
	<div class="container">
		<div class="row">
			<div class="col-xs-6 col-sm-6 col-md-6 more-padding">
				<img src="/images/youtube.png" alt="youtube"> Watch our <a href="https://www.youtube.com/channel/UC7bsuzp2BfL5F5RX07oLIzw">movies</a> and follow us on <a href="http://facebook.com/dobots">Facebook!</a>
</div>
			<div class="col-xs-6 col-sm-6 col-md-6">
				<ul class="list-items pull-right gutter-top-btm">
					<li><a href="index.html">
						<img src="/images/footer-logo.png" class="img-responsive" alt="DoBots"></a></li>
					<li class="robot-info-dilog">
<a href="#">
						<img src="/images/two-robot.png" width="103" height="85" alt="robot">
					</a>
					<div class="footer-robot-dilog">
						<div class="inner-robot-dilog">
							Do you have a question? <script type="text/javascript">/*<![CDATA[*/var a=new Array(".nl","bots","do","@","fo","in");document.write("<a href='mailto:");for(i=a.length-1;i>=0;i--){document.write(a[i])}document.write("?subject=DoBots Contact' class='btn btn-default'>Yes</a>");/*]]>*/</script>
							<div class="inner-arrow-right">
								<img alt="dilog" class="img-responsive" src="/images/inner-dilog.png" draggable="false"> </div>
						</div>

					</div>
					</li>
				</ul>

			</div>
		</div>
	</div>
</footer>




  <script type="text/javascript">
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-17146802-10', 'auto');
ga('send', 'pageview');
</script>
<script type="text/javascript" async src="https://www.google-analytics.com/analytics.js"></script>






<!-- in debug mode, Google Chrome worries about .map files, do not worry -->


<script type="text/javascript" src="/assets/jquery.min-7f30f220312176c728c3bb41a567ccc2e1ce2e7a8dd7c9cefd59fe197ba047b2.js"></script>

<!-- Latest compiled and minified JavaScript -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script type="text/javascript" src="/assets/jquery.flexslider-122776e067a7b77f685ce8fbbd3cb75136ce8ca23f243a50de28c1545ec6bb68.js"></script>

<script type="text/javascript" async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script type="text/javascript">
$(window).load(function(){
		$('.text-slider').flexslider({
			animation: "slide",
			start: function(slider){
				$('body').removeClass('loading');
			}
		});
	});
</script>

</div>
</body>
</html>
