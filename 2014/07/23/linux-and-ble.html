<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Distributed Organisms B.V., shorthand DoBots, specializes in Smart Robots and Smart Buildings. DoBots implements localization, mapping, and navigation algorithms on robots and indoor localization, automation, and tracking algorithms in buildings.">
<meta name="author" content="Distributed Organisms B.V.">
<link rel="icon" type="image/x-icon" href="/images/favicon.ico?">
<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="72x72" href="/images/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="114x114" href="/images/apple-touch-icon-114x114.png">


<title>DoBots | Linux and BLE</title>


<meta name="description" content="Linux and Bluetooth Low-Energy (BLE)">

<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<link rel="stylesheet" type="text/css" href="/assets/elusive-webfont-b4b08c54aa385fbc9433a5864604eb0a37430d49016644f6c2225b9c9f6528d4.css">

<!-- Custom styles for this template -->

<link rel="stylesheet" type="text/css" href="/assets/flexslider-af37d743866caa19c33f16fdb8585f2b6331c7b25bfcb9b0b2fd4720d61df9b5.css">
<link rel="stylesheet" type="text/css" href="/assets/dobots-style-6a93bbafd311befa179f35a7f457349cb1b7ed24686877defdb4530f84dcc1fe.css">

<!--[if lt IE 9]>
	<script src="/assets/themes//resources/respond/Respond.min.js"></script>
<![endif]-->

<link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
<link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">


</head>

<body>
    <!--
<div id="headerBar" onclick="location.href='http://crownstone.rocks';">
<center>
<h4>
<a href="http://crownstone.rocks/">http://crownstone.rocks</a> power outlet!
</h4>
</center>
</div>
    -->
<header id="header" class="mini-wrap">
	<div class="navbar navbar-inverse" role="navigation">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="/"><img src="/images/logo.png" class="img-responsive" alt="DoBots"></a>
			</div>

			<div class="collapse navbar-collapse">
				<ul class="nav navbar-nav navbar-right main-nav">
					
					
					


  
    
      
    
  
    
      
      	
      	<li><a href="/applications/cleaning/">Applications</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/products/autopilot/">Technology</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/jobs/">Jobs</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/blog/">Blog</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/about-us/">About</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/search/">Search</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
	<li><a href="mailto:info@dobots.nl?subject=Get%20in%20contact">Contact</a></li>




				</ul>
			</div>
		</div>
	</div>
</header>

<section id="sub-menu" class="mini-wrap">
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<ul class="list-unstyled sub-menu pull-left slogan">
					<!--					<li>"Computers, come, join us in the real world!"</li> -->
					<li>
<a href="/2014/05/23/best-european-startup/">Best European Startup Award</a> winner of <a href="http://robotlaunch.com/">Robot Launch</a>!
					</li>
				</ul>
                <!--
				<ul class="list-unstyled sub-menu pull-right">
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
						
					
					
						
						
							
							
							
							
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
								
							
						
					
				</ul>
                -->
			</div>
		</div>
	</div>
</section> <!--end / sub-menu-->


<!--
<div class="page-header">
  <h1>Linux and BLE </h1>
</div>
-->

<div class="container">
	<div class="row post-full">
		<div class="col-md-12">
			<div class="date">
				<strong class="date_month">Jul</strong>
				<strong class="date_day">23</strong>
				<strong class="date_year">2014</strong>
				<!--      <span>23 July 2014</span> -->
			</div>
			
			
			<div class="author-block">
				
				<img src="https://secure.gravatar.com/avatar/818dc2df03cd2f1ca7d6e6e701052f0c?s=40">
				
				<span class="author">Anne van Rossum</span>
			</div>
			
			<div class="post">
				<div class="content">
					
<h1 id="linux-and-bluetooth-low-energy">Linux and Bluetooth Low-Energy</h1>

<p>Although not strictly Linux, Android being a VM on top of a Linux kernel, and iOS being based on top of Darwin, the Unix-like OS from Apple, I just add for your convenience.</p>

<h2 id="android">Android</h2>

<p>On Android you definitely need the <a href="https://play.google.com/store/apps/details?id=no.nordicsemi.android.mcp&amp;hl=en">nRF Master Control Panel</a>. This is a great tool which you can even use to upload new firmware to a device. It is very often updated and seems to be used internally at Nordic as well. Bugs pop up so now and then, but they plet them at a fast rate.</p>

<h2 id="ios">iOS</h2>

<p>A convenient tool on iOS is <a href="https://itunes.apple.com/us/app/ble-utility/id606210918?mt=8">BLE Utility</a>. It is graphical nice and clean and it shows all services and characteristics you need. You can easily set a characteristic that you have defined yourself on a custom BLE device.</p>

<h2 id="ubuntu">Ubuntu</h2>

<p>There are plenty of BLE dongles you can buy if your laptop (or raspberry pi) does not support Bluetooth Low-Energy, Bluetooth 4, Bluetooth Smart, or iBeacon (whatever they call it nowadays) out of the box. We ordered a few at <a href="http://www.miniinthebox.com/nl/3mbps-bluetooth-mvo-usb-dongle-met-20m-werkbereik_p367687.html">MiniInTheBox</a> that have <a href="http://www.csr.com/products/technology/low-energy">CSR</a> (Cambridge Silicon Radio) as label.</p>

<p>Type in <code>hciconfig</code> before and after you plug in the new dongle.</p>

<p>You probably see something along the lines:</p>

<pre><code>hci1:	Type: BR/EDR  Bus: USB
	BD Address: 00:1A:7D:DA:71:13  ACL MTU: 310:10  SCO MTU: 64:8
	UP RUNNING PSCAN 
	RX bytes:33907 acl:14 sco:0 events:1406 errors:0
	TX bytes:1524 acl:18 sco:0 commands:63 errors:0
</code></pre>

<p>And another device that represents your good old-fashioned standard Bluetooth radio.</p>

<p>We can reach all new fancy BLE functionality through an old, familiar tool, <code>hcitool</code> with function that are now prepended with <code>le</code>:</p>

<pre><code>✗ sudo hcitool -i hci1 lescan
</code></pre>

<p>With the output:</p>

<pre><code>LE Scan ...
CF:72:4E:70:A6:DB Crown
CF:72:4E:70:A6:DB (unknown)
</code></pre>

<p>Here you see one of our <a href="/products/crownstone">Crownstone</a>s.</p>

<p>Connecting to it:</p>

<pre><code>✗ sudo gatttool -i hci1 -b CF:72:4E:70:A6:DB -I
[   ][CF:72:4E:70:A6:DB][LE]&gt; connect
Connecting... connect error: Connection refused (111)
</code></pre>

<p>Fails… And now you get a time saving command from me. You first tell that you don’t care about your own address, which can be random:</p>

<pre><code>sudo hcitool -i hci1 lecc --random CF:72:4E:70:A6:DB
Connection handle 70

✗ sudo gatttool -i hci1 -b CF:72:4E:70:A6:DB --interactive
[   ][CF:72:4E:70:A6:DB][LE]&gt; connect
</code></pre>

<p>We can get the services:</p>

<pre><code>[CON][CF:72:4E:70:A6:DB][LE]&gt; primary
attr handle: 0x0001, end grp handle: 0x0007 uuid: 00001800-0000-1000-8000-00805f9b34fb
attr handle: 0x0008, end grp handle: 0x000b uuid: 00001801-0000-1000-8000-00805f9b34fb
attr handle: 0x000c, end grp handle: 0xffff uuid: 00002220-0000-1000-8000-00805f9b34fb
</code></pre>

<p>And the characteristics:</p>

<pre><code>[CON][CF:72:4E:70:A6:DB][LE]&gt; characteristics
handle: 0x0002, char properties: 0x0a, char value handle: 0x0003, uuid: 00002a00-0000-1000-8000-00805f9b34fb
handle: 0x0004, char properties: 0x02, char value handle: 0x0005, uuid: 00002a01-0000-1000-8000-00805f9b34fb
handle: 0x0006, char properties: 0x02, char value handle: 0x0007, uuid: 00002a04-0000-1000-8000-00805f9b34fb
handle: 0x0009, char properties: 0x20, char value handle: 0x000a, uuid: 00002a05-0000-1000-8000-00805f9b34fb
handle: 0x000d, char properties: 0x0e, char value handle: 0x000e, uuid: 00002201-0000-1000-8000-00805f9b34fb
handle: 0x0011, char properties: 0x0e, char value handle: 0x0012, uuid: 00000125-0000-1000-8000-00805f9b34fb
handle: 0x0015, char properties: 0x0e, char value handle: 0x0016, uuid: 00000124-0000-1000-8000-00805f9b34fb
</code></pre>

<p>Of course <code>help</code> works. Let us now try to turn on/off the Crownstone with the <a href="https://github.com/mrquincle/bluenet">BlueNet software running</a>. I know that it should be uuid 0x0124 for the characteristic, but let us figure out which handle that is:</p>

<pre><code>[CON][CF:72:4E:70:A6:DB][LE]&gt; char-desc 0x0015
handle: 0x0015, uuid: 2803
handle: 0x0016, uuid: 0124
handle: 0x0017, uuid: 2901
handle: 0x0018, uuid: 2904
</code></pre>

<p>Apparently handle 0x0016, it is empty on read:</p>

<pre><code>[CON][CF:72:4E:70:A6:DB][LE]&gt; char-read-hnd 0x0016
Characteristic value/descriptor: 
</code></pre>

<p>However, we can write to it:</p>

<pre><code>[CON][CF:72:4E:70:A6:DB][LE]&gt; char-write-cmd 0x0016 0xFF
</code></pre>

<p>And the switch turns on!</p>


				</div>

				

				
				<div class="tag_box inline">
					<i class="icon-tags"></i>

					
					


  
     
    	<a href="/tags.html#bluetooth%20smart-ref">bluetooth smart</a> 
     
    	<a href="/tags.html#ble-ref">ble</a> 
    
  




				</div>
				
				<hr>

				<div class="social-button-footer">
					<p>
					<a class="btn btn-social-icon btn-twitter" href="http://twitter.com/intent/tweet?url=https://dobots.nl/2014/07/23/linux-and-ble&amp;text=Linux%20and%20BLE"><i class="icon-twitter"></i></a>
					<a class="btn btn-social-icon btn-facebook" href="http://facebook.com/sharer.php?u=https://dobots.nl/2014/07/23/linux-and-ble"><i class="icon-facebook"></i></a>
					<a class="btn btn-social-icon btn-googleplus" href="https://plus.google.com/share?url=https://dobots.nl/2014/07/23/linux-and-ble"><i class="icon-googleplus"></i></a>
					<a class="btn btn-social-icon btn-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://dobots.nl/2014/07/23/linux-and-ble"><i class="icon-linkedin"></i></a>
					<a class="btn btn-social-icon btn-reddit" href="http://reddit.com/submit?url=https://dobots.nl/2014/07/23/linux-and-ble&amp;title=Linux%20and%20BLE"><i class="icon-reddit"></i></a>
					</p>
				</div>


				<ul class="pagination">
					
					<li class="prev"><a href="/2014/07/15/ble-dobeacon-a-virtual-memo" title="BLE, doBeacon, a Virtual Memo">← Previous</a></li>
					
					<li><a href="/blog">Archive</a></li>
					
					<li class="next"><a href="/2014/08/02/european-webshops-for-diy-robots" title="European webshops for DIY robots">Next →</a></li>
					
				</ul>
				<hr>
				


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'dobots'; 
    
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<a href="https://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




			</div>
		</div>
	</div>



<footer id="footer" class="mini-wrap gray">
	<div class="container">
		<div class="row">
			<div class="col-xs-6 col-sm-6 col-md-6 more-padding">
				<img src="/images/youtube.png" alt="youtube"> Watch our <a href="https://www.youtube.com/channel/UC7bsuzp2BfL5F5RX07oLIzw">movies</a> and follow us on <a href="http://facebook.com/dobots">Facebook!</a>
</div>
			<div class="col-xs-6 col-sm-6 col-md-6">
				<ul class="list-items pull-right gutter-top-btm">
					<li><a href="index.html">
						<img src="/images/footer-logo.png" class="img-responsive" alt="DoBots"></a></li>
					<li class="robot-info-dilog">
<a href="#">
						<img src="/images/two-robot.png" width="103" height="85" alt="robot">
					</a>
					<div class="footer-robot-dilog">
						<div class="inner-robot-dilog">
							Do you have a question? <script type="text/javascript">/*<![CDATA[*/var a=new Array(".nl","bots","do","@","fo","in");document.write("<a href='mailto:");for(i=a.length-1;i>=0;i--){document.write(a[i])}document.write("?subject=DoBots Contact' class='btn btn-default'>Yes</a>");/*]]>*/</script>
							<div class="inner-arrow-right">
								<img alt="dilog" class="img-responsive" src="/images/inner-dilog.png" draggable="false"> </div>
						</div>

					</div>
					</li>
				</ul>

			</div>
		</div>
	</div>
</footer>




  <script type="text/javascript">
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-17146802-10', 'auto');
ga('send', 'pageview');
</script>
<script type="text/javascript" async src="https://www.google-analytics.com/analytics.js"></script>






<!-- in debug mode, Google Chrome worries about .map files, do not worry -->


<script type="text/javascript" src="/assets/jquery.min-7f30f220312176c728c3bb41a567ccc2e1ce2e7a8dd7c9cefd59fe197ba047b2.js"></script>

<!-- Latest compiled and minified JavaScript -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script type="text/javascript" src="/assets/jquery.flexslider-122776e067a7b77f685ce8fbbd3cb75136ce8ca23f243a50de28c1545ec6bb68.js"></script>

<script type="text/javascript" async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script type="text/javascript">
$(window).load(function(){
		$('.text-slider').flexslider({
			animation: "slide",
			start: function(slider){
				$('body').removeClass('loading');
			}
		});
	});
</script>

</div>
</body>
</html>
